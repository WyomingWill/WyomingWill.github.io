<html>
<head>
<title>spring2D</title>
<style type="text/css">
<!--
  :link { color: rgb(110, 0, 110); } 
  :visited { color: rgb(110, 0, 110); } 
  body { margin-left: 5px; font-family: arial, sans-serif; 
         background: white; font-size: 12pt } 
  h2 { background: rgb(166,172,255); 
       font-size: 15pt; 
       padding-left: 6px; padding-right: 6px; padding-top: 6px; 
       padding-bottom: 6px; } 
  p { margin-left: 10px; } 
  pre { margin-left: 13px; background: rgb(225,225,225); 
        font-family: monospace; padding-left: 3px; padding-right: 3px; 
        padding-top: 3px; padding-bottom: 3px; } 
-->
</style>
</head>
<body>

<p>This page was automatically generated by NetLogo 4.1.3.</p>

<p>The applet requires Java 5 or higher.
Java must be enabled in your browser settings.
Mac users must have Mac OS X 10.4 or higher.
Windows and Linux users may obtain the latest Java from
<a href="http://java.sun.com/getjava/download.html">Sun's Java site</a>.</p>

<p>
<applet code="org.nlogo.lite.Applet"
        archive="NetLogoLite.jar"
        width="733" height="644">
  <param name="DefaultModel"
         value="spring2D.nlogo">
</applet>
</p>

<p>powered by
<a target="_blank" href="http://ccl.northwestern.edu/netlogo/">NetLogo</a></p>

<p>view/download model file:
<a href="spring2D.nlogo">spring2D.nlogo</a>
</p>
<h2>WHAT IS IT?</h2>
<p>This is a model of a two-dimensional spring, for the book entitled &quot;Physicomimetics: Physics-Based Swarm Intelligence.&quot;</p><br>
<h2>HOW IT WORKS</h2>
<p>Two particles use F = ma and Hooke's law to move as a spring. But now the spring is given angular momentum, allowing it to spin around the center of mass.</p><br>
<h2>HOW TO USE IT</h2>
<p>Click SETUP AGENTS to initialize the two particles, and click MOVE AGENTS to have them move. </p>
<p>The MASS_RATIO slider allows you to control the relative masses of the particles at the ends of the spring, at initialization.  Changing this slider while the simulation is running will have no effect. </p>
<p>The ANGULAR_MOTION slider allows you to impart a spin to the system at initialization. The spin is established very carefully to make sure that there is no linear momentum at initialization. Changing this slider while the simulation is running will have no effect.</p>
<p>All other sliders will affect the simulation when it is running.</p><br>
<h2>THINGS TO NOTICE</h2>
<p>This simulation serves to teach you a simple model of a spring, as well as introduce you to more advanced concepts, such as the Conservation of Linear Momentum, Conservation of Angular Momentum, and the Conservation of Energy. This is covered in detail in Chapter 2 of the book. </p>
<p>Note how raising the TIME_STEP introduces very mild variations into the Conservation of Energy graph.  The total energy is shown in brown, the kinetic energy is in green, and the potential energy is in blue. The total energy stays relatively constant while there is a constant tradeoff between potential and kinetic energy. Watch the simulation - when is kinetic energy high? When is potential energy high?</p>
<p>What happens when FRICTION is raised from 0.000 to 0.001? Where has the energy gone?</p>
<p>The red dot in the simulation shows the center of mass of the system. If the Conservation of Linear Momentum holds, the red dot will not move. In this simulation, if one of the particles crosses the boundary of the world (re-entering from the other side), the center of mass will change because the standard physics assumption of an Euclidean geometry has been broken (as explained in Chapter 2).</p>
<p>This simulation also includes a monitor for the Angular Momentum and you will see that it does not change over time, unless one of the particles crosses the boundary of the world (re-entering from the other side). Again, this is because the standard physics assumption of an Euclidean geometry has been broken (as explained in Chapter 2).</p><br>
<h2>THINGS TO TRY</h2>
<p>See how the SPRING_CONSTANT changes behavior. </p>
<p>What happens when you damp the spring with FRICTION? </p>
<p>What happens if you make one of the particles heavier by using the MASS_RATIO slider (this must be done before you click SETUP AGENTS)?  </p>
<p>Try different values of ANGULAR_MOMENTUM (even zero).</p><br>
<h2>EXTENDING THE MODEL</h2>
<p>Currently, the MASS_RATIO slider is only used during the initialization of the two particles. Hence, changing this slider while the simulation is running will have no effect. Modify the code to monitor this slider always (hint: you can do this in the &quot;update-info&quot; procedure), so that the mass of particle 1 can be changed dynamically.</p>
<p>Introduce a third particle and create a more complex structure that contains three springs. Use different spring constants for the three springs. One way to do this is to initially create three particles (by saying &quot;crt 3&quot;): 0, 1, and 2. Then you will need to modify &quot;setup-turtles&quot; so that it initializes all three particles in an appropriate manner. Finally, the &quot;ap&quot; procedure needs to be modified so that it knows which pair of particles are interacting (0 and 1, 0 and 2, or 1 and 2). You will want to have a different value of &quot;k&quot; for each pair. Impart a spin to the system. What happens? </p>
<p>Note, in order to change any NetLogo simulation, you must have the source code (i.e., &quot;spring2D.nlogo&quot;) downloaded to your computer, as well as NetLogo itself. You can not change the code when you are running the simulation with your browser.</p><br>
<h2>NETLOGO FEATURES</h2>
<p>Since we are using a patch size of one, we wanted the particles to be more visible. This is done with &quot;set size 5&quot; in the code. However, they are still considered to be point particles (with no size) in the simulation.</p>
<p>Note also how the &quot;do-plots&quot; procedure draws the Energy graph and the Separation graph.</p>
<p>NetLogo provides built-in commands to model springs, but for the purposes of this book it is better to see how a spring works from first principles. In fact, one of the core concepts of this book is that the better we understand first principles, the more elegant our solutions will be.</p><br>
<h2>RELATED MODELS</h2>
<p>This is our second simulation, which builds on the one-dimensional spring model. It will be generalized more and more throughout the book.</p><br>
<h2>CREDITS AND REFERENCES</h2><br>
<h2>HOW TO CITE</h2>
<p>If you mention this model in an academic publication, we ask that you include these citations for the model itself and for the NetLogo software:<br>- Spears, William M. and Spears, Diana F. (eds.) Physicomimetics: Physics-Based Swarm Intelligence, Springer-Verlag, (2011).<br>- Wilensky, U. (1999). NetLogo. <a href="http://ccl.northwestern.edu/netlogo/">http://ccl.northwestern.edu/netlogo/</a>. Center for Connected Learning and Computer-Based Modeling, Northwestern University, Evanston, IL.</p><br>
<h2>COPYRIGHT NOTICE</h2>
<p>Copyright 2011 William M. Spears. All rights reserved.</p>
<p>Permission to use, modify or redistribute this model is hereby granted, provided that both of the following requirements are followed:<br>a) this copyright notice is included, and<br>b) this model will not be redistributed for profit without permission from William M. Spears. Contact William M. Spears for appropriate licenses for redistribution for profit.</p>
<p><a href="http://www.swarmotics.com">http://www.swarmotics.com</a></p><br>
<h2>PROCEDURES</h2>
<pre><font color="#5a5a5a">; William M. Spears September 2011</font><font color="#000000">
</font><font color="#5a5a5a">; 2D Spring Law Tutorial Code</font><font color="#000000">
</font><font color="#5a5a5a">; For research and educational use only</font><font color="#000000">

</font><font color="#007f69">globals</font><font color="#000000"> [total_lmx total_lmy total_angular_mom total_ke total_pe total_energy 
         center_of_mass_x center_of_mass_y k FR DeltaT D S maxS minS]

</font><font color="#007f69">turtles-own</font><font color="#000000"> [hood deltax deltay r F Fx Fy v vx vy dvx dvy mass ke 
             lmx lmy theta lever_arm_x lever_arm_y lever_arm_r angular_mom]

</font><font color="#007f69">to</font><font color="#000000"> setup
   </font><font color="#0000aa">clear-all</font><font color="#000000">                                   </font><font color="#5a5a5a">; Clear everything</font><font color="#000000">
   </font><font color="#0000aa">crt</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">                                       </font><font color="#5a5a5a">; Create two turtles (particles)</font><font color="#000000">
   update-info                                 
   </font><font color="#0000aa">set</font><font color="#000000"> maxS </font><font color="#963700">0</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> minS </font><font color="#963700">100000</font><font color="#000000">                  </font><font color="#5a5a5a">; Initialize some variables</font><font color="#000000">
   </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [setup-turtles]                 </font><font color="#5a5a5a">; Set up the two particles</font><font color="#000000">
   
                                               </font><font color="#5a5a5a">; Compute initial separation</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> S </font><font color="#660096">sqrt</font><font color="#000000"> (((([</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) </font><font color="#660096">-</font><font color="#000000"> ([</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">)) </font><font color="#660096">*</font><font color="#000000"> 
                (([</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) </font><font color="#660096">-</font><font color="#000000"> ([</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">))) </font><font color="#660096">+</font><font color="#000000"> 
               ((([</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) </font><font color="#660096">-</font><font color="#000000"> ([</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">)) </font><font color="#660096">*</font><font color="#000000"> 
                (([</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) </font><font color="#660096">-</font><font color="#000000"> ([</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">))))

                                               </font><font color="#5a5a5a">; Computes center of mass and displays location</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> center_of_mass_x (([mass] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> ([</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">+</font><font color="#000000"> 
                         ([mass] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> ([</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">)) </font><font color="#660096">/</font><font color="#000000"> 
                        (([mass] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">+</font><font color="#000000"> ([mass] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">))
   </font><font color="#0000aa">set</font><font color="#000000"> center_of_mass_y (([mass] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> ([</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">+</font><font color="#000000"> 
                         ([mass] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> ([</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">)) </font><font color="#660096">/</font><font color="#000000"> 
                        (([mass] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">+</font><font color="#000000"> ([mass] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">))
   </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patch</font><font color="#000000"> (</font><font color="#660096">round</font><font color="#000000"> center_of_mass_x) (</font><font color="#660096">round</font><font color="#000000"> center_of_mass_y)
      [</font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">in-radius</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000">]]
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> run-and-monitor
   </font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) [</font><font color="#0000aa">user-message</font><font color="#000000"> </font><font color="#963700">&quot;Please click HALT and then SETUP AGENTS first&quot;</font><font color="#000000"> </font><font color="#0000aa">stop</font><font color="#000000">]
   update-info
   </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [ap]
   </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [move]
                                               </font><font color="#5a5a5a">; Computes center of mass and displays location</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> center_of_mass_x (([mass] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> ([</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">+</font><font color="#000000"> 
                         ([mass] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> ([</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">)) </font><font color="#660096">/</font><font color="#000000"> 
                        (([mass] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">+</font><font color="#000000"> ([mass] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">))
   </font><font color="#0000aa">set</font><font color="#000000"> center_of_mass_y (([mass] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> ([</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">+</font><font color="#000000"> 
                         ([mass] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> ([</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">)) </font><font color="#660096">/</font><font color="#000000"> 
                        (([mass] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">+</font><font color="#000000"> ([mass] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">))
   </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patch</font><font color="#000000"> (</font><font color="#660096">round</font><font color="#000000"> center_of_mass_x) (</font><font color="#660096">round</font><font color="#000000"> center_of_mass_y)
      [</font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">in-radius</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000">]]

   </font><font color="#0000aa">if</font><font color="#000000"> (S </font><font color="#660096">&gt;</font><font color="#000000"> maxS) [</font><font color="#0000aa">set</font><font color="#000000"> maxS S]
   </font><font color="#0000aa">if</font><font color="#000000"> (S </font><font color="#660096">&lt;</font><font color="#000000"> minS) [</font><font color="#0000aa">set</font><font color="#000000"> minS S]

   </font><font color="#0000aa">set</font><font color="#000000"> total_lmx </font><font color="#660096">sum</font><font color="#000000"> [lmx] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">          </font><font color="#5a5a5a">; Total linear momentum, x-component</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> total_lmy </font><font color="#660096">sum</font><font color="#000000"> [lmy] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">          </font><font color="#5a5a5a">; Total linear momentum, y-component</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> total_angular_mom </font><font color="#660096">sum</font><font color="#000000"> [angular_mom] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> total_ke </font><font color="#660096">sum</font><font color="#000000"> [ke] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">            </font><font color="#5a5a5a">; Total kinetic energy of both particles</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> total_pe (k </font><font color="#660096">*</font><font color="#000000"> (S </font><font color="#660096">-</font><font color="#000000"> D) </font><font color="#660096">*</font><font color="#000000"> (S </font><font color="#660096">-</font><font color="#000000"> D) </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">)    </font><font color="#5a5a5a">; Compute potential energy</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> total_energy (total_ke </font><font color="#660096">+</font><font color="#000000"> total_pe)      </font><font color="#5a5a5a">; Total energy of the two-particle system</font><font color="#000000">
   </font><font color="#0000aa">tick</font><font color="#000000">
   do-plots
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> setup-turtles
   </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">white</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> vy </font><font color="#963700">0</font><font color="#000000">                    </font><font color="#5a5a5a">; Start with no y motion on either particle</font><font color="#000000">
   </font><font color="#0000aa">home</font><font color="#000000">                                        </font><font color="#5a5a5a">; Set particles at (0,0) which is the center of the screen</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;circle&quot;</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#963700">5</font><font color="#000000">               </font><font color="#5a5a5a">; Draw the particle as a large circle</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">360</font><font color="#000000"> </font><font color="#0000aa">fd</font><font color="#000000"> (</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> D)    </font><font color="#5a5a5a">; Each particle receives a random heading and moves forward</font><font color="#000000">
   
   </font><font color="#0000aa">ifelse</font><font color="#000000"> (</font><font color="#660096">who</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">)                            </font><font color="#5a5a5a">; To allow for unequal masses of the two-particle system</font><font color="#000000">
      [</font><font color="#0000aa">set</font><font color="#000000"> mass </font><font color="#963700">1</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> vx Angular_Motion]       </font><font color="#5a5a5a">; Particle 0 has mass = 1</font><font color="#000000">
      [</font><font color="#0000aa">set</font><font color="#000000"> mass Mass_Ratio                     </font><font color="#5a5a5a">; Particle 1 has mass = Mass_Ratio &gt; 1</font><font color="#000000">
       </font><font color="#0000aa">set</font><font color="#000000"> vx (</font><font color="#660096">-</font><font color="#000000"> Angular_Motion) </font><font color="#660096">/</font><font color="#000000"> Mass_Ratio]
   </font><font color="#0000aa">set</font><font color="#000000"> theta </font><font color="#963700">0</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> ap                                          </font><font color="#5a5a5a">; Run artificial physics</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> vx (</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> FR) </font><font color="#660096">*</font><font color="#000000"> vx                        </font><font color="#5a5a5a">; Slow down according to friction</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> vy (</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> FR) </font><font color="#660096">*</font><font color="#000000"> vy
   
   </font><font color="#0000aa">set</font><font color="#000000"> hood [</font><font color="#660096">who</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">other</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">             </font><font color="#5a5a5a">; Get the IDs of your neighbors</font><font color="#000000">
   </font><font color="#0000aa">foreach</font><font color="#000000"> hood [                     
      </font><font color="#0000aa">set</font><font color="#000000"> deltax (([</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> ?) </font><font color="#660096">-</font><font color="#000000"> </font><font color="#660096">xcor</font><font color="#000000">) 
      </font><font color="#0000aa">set</font><font color="#000000"> deltay (([</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> ?) </font><font color="#660096">-</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000">) 
      </font><font color="#0000aa">set</font><font color="#000000"> r </font><font color="#660096">sqrt</font><font color="#000000"> (deltax </font><font color="#660096">*</font><font color="#000000"> deltax </font><font color="#660096">+</font><font color="#000000"> deltay </font><font color="#660096">*</font><font color="#000000"> deltay)
      </font><font color="#0000aa">set</font><font color="#000000"> S r
      </font><font color="#0000aa">set</font><font color="#000000"> F (k </font><font color="#660096">*</font><font color="#000000"> (r </font><font color="#660096">-</font><font color="#000000"> D))                      </font><font color="#5a5a5a">; The spring law</font><font color="#000000">
      </font><font color="#0000aa">set</font><font color="#000000"> Fx (F </font><font color="#660096">*</font><font color="#000000"> (deltax </font><font color="#660096">/</font><font color="#000000"> r))                </font><font color="#5a5a5a">; The x-component of force</font><font color="#000000">
      </font><font color="#0000aa">set</font><font color="#000000"> Fy (F </font><font color="#660096">*</font><font color="#000000"> (deltay </font><font color="#660096">/</font><font color="#000000"> r))                </font><font color="#5a5a5a">; The y-component of force</font><font color="#000000">
   ]
   
   </font><font color="#0000aa">set</font><font color="#000000"> dvx DeltaT </font><font color="#660096">*</font><font color="#000000"> (Fx </font><font color="#660096">/</font><font color="#000000"> mass)
   </font><font color="#0000aa">set</font><font color="#000000"> dvy DeltaT </font><font color="#660096">*</font><font color="#000000"> (Fy </font><font color="#660096">/</font><font color="#000000"> mass)
   </font><font color="#0000aa">set</font><font color="#000000"> vx  (vx </font><font color="#660096">+</font><font color="#000000"> dvx)                          </font><font color="#5a5a5a">; The x-component of velocity</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> vy  (vy </font><font color="#660096">+</font><font color="#000000"> dvy)                          </font><font color="#5a5a5a">; The y-component of velocity</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> deltax DeltaT </font><font color="#660096">*</font><font color="#000000"> vx
   </font><font color="#0000aa">set</font><font color="#000000"> deltay DeltaT </font><font color="#660096">*</font><font color="#000000"> vy 
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> move                                        </font><font color="#5a5a5a">; Move the turtle</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">xcor</font><font color="#000000"> (</font><font color="#660096">xcor</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> deltax)
   </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000"> (</font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> deltay)

   </font><font color="#0000aa">set</font><font color="#000000"> lmx (mass </font><font color="#660096">*</font><font color="#000000"> vx)                         </font><font color="#5a5a5a">; Linear momentum of the turtle</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> lmy (mass </font><font color="#660096">*</font><font color="#000000"> vy)
   
   </font><font color="#0000aa">set</font><font color="#000000"> v </font><font color="#660096">sqrt</font><font color="#000000"> (vx </font><font color="#660096">*</font><font color="#000000"> vx </font><font color="#660096">+</font><font color="#000000"> vy </font><font color="#660096">*</font><font color="#000000"> vy)
   </font><font color="#0000aa">set</font><font color="#000000"> ke (v </font><font color="#660096">*</font><font color="#000000"> v </font><font color="#660096">*</font><font color="#000000"> mass </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">)                   </font><font color="#5a5a5a">; Kinetic energy of the turtle</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> lever_arm_x (</font><font color="#660096">xcor</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> center_of_mass_x)
   </font><font color="#0000aa">set</font><font color="#000000"> lever_arm_y (</font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> center_of_mass_y)
   </font><font color="#0000aa">set</font><font color="#000000"> lever_arm_r </font><font color="#660096">sqrt</font><font color="#000000"> (lever_arm_x </font><font color="#660096">*</font><font color="#000000"> lever_arm_x </font><font color="#660096">+</font><font color="#000000"> lever_arm_y </font><font color="#660096">*</font><font color="#000000"> lever_arm_y)
   </font><font color="#0000aa">if</font><font color="#000000"> (((vx </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">or</font><font color="#000000"> (vy </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">)) </font><font color="#660096">and</font><font color="#000000"> ((lever_arm_x </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">or</font><font color="#000000"> (lever_arm_y </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">)))
      [</font><font color="#0000aa">set</font><font color="#000000"> theta (</font><font color="#660096">atan</font><font color="#000000"> (mass </font><font color="#660096">*</font><font color="#000000"> vy) (mass </font><font color="#660096">*</font><font color="#000000"> vx)) </font><font color="#660096">-</font><font color="#000000"> (</font><font color="#660096">atan</font><font color="#000000"> lever_arm_y lever_arm_x)]
   </font><font color="#0000aa">set</font><font color="#000000"> angular_mom (lever_arm_r </font><font color="#660096">*</font><font color="#000000"> mass </font><font color="#660096">*</font><font color="#000000"> v </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#660096">sin</font><font color="#000000"> theta)) </font><font color="#5a5a5a">; Angular momentum of the turtle</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> update-info                                 </font><font color="#5a5a5a">; Update information from the sliders</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> k Spring_Constant
   </font><font color="#0000aa">set</font><font color="#000000"> FR Friction
   </font><font color="#0000aa">set</font><font color="#000000"> DeltaT Time_Step
   </font><font color="#0000aa">set</font><font color="#000000"> D Desired_Spring_Length
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> do-plots
   </font><font color="#0000aa">set-current-plot</font><font color="#000000"> </font><font color="#963700">&quot;Energy&quot;</font><font color="#000000">                   </font><font color="#5a5a5a">; Select the Energy plot</font><font color="#000000">
   </font><font color="#0000aa">set-current-plot-pen</font><font color="#000000"> </font><font color="#963700">&quot;Total&quot;</font><font color="#000000">                </font><font color="#5a5a5a">; Select the Total Energy Pen</font><font color="#000000">
   </font><font color="#0000aa">plot</font><font color="#000000"> total_energy                           </font><font color="#5a5a5a">; Plot the total_energy</font><font color="#000000">
   </font><font color="#0000aa">set-current-plot-pen</font><font color="#000000"> </font><font color="#963700">&quot;Potential&quot;</font><font color="#000000">
   </font><font color="#0000aa">plot</font><font color="#000000"> total_pe
   </font><font color="#0000aa">set-current-plot-pen</font><font color="#000000"> </font><font color="#963700">&quot;Kinetic&quot;</font><font color="#000000">
   </font><font color="#0000aa">plot</font><font color="#000000"> total_ke

   </font><font color="#0000aa">set-current-plot</font><font color="#000000"> </font><font color="#963700">&quot;Separation&quot;</font><font color="#000000">               </font><font color="#5a5a5a">; Select the Separation plot</font><font color="#000000">
   </font><font color="#0000aa">set-plot-y-range</font><font color="#000000"> </font><font color="#660096">precision</font><font color="#000000"> (minS </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) </font><font color="#963700">0</font><font color="#000000">     </font><font color="#5a5a5a">; Set the range of the y-axis</font><font color="#000000">
                    </font><font color="#660096">precision</font><font color="#000000"> (maxS </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) </font><font color="#963700">0</font><font color="#000000">
   </font><font color="#0000aa">set-current-plot-pen</font><font color="#000000"> </font><font color="#963700">&quot;Sep&quot;</font><font color="#000000">                  </font><font color="#5a5a5a">; Select the Sep pen</font><font color="#000000">
   </font><font color="#0000aa">plot</font><font color="#000000"> S                                      </font><font color="#5a5a5a">; Plot the separation</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">
</font>
</pre>

</body>
</html>
