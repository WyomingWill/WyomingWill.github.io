<html>
<head>
<title>apo</title>
<style type="text/css">
<!--
  :link { color: rgb(110, 0, 110); } 
  :visited { color: rgb(110, 0, 110); } 
  body { margin-left: 5px; font-family: arial, sans-serif; 
         background: white; font-size: 12pt } 
  h2 { background: rgb(166,172,255); 
       font-size: 15pt; 
       padding-left: 6px; padding-right: 6px; padding-top: 6px; 
       padding-bottom: 6px; } 
  p { margin-left: 10px; } 
  pre { margin-left: 13px; background: rgb(225,225,225); 
        font-family: monospace; padding-left: 3px; padding-right: 3px; 
        padding-top: 3px; padding-bottom: 3px; } 
-->
</style>
</head>
<body>

<p>This page was automatically generated by NetLogo 4.1.3.</p>

<p>The applet requires Java 5 or higher.
Java must be enabled in your browser settings.
Mac users must have Mac OS X 10.4 or higher.
Windows and Linux users may obtain the latest Java from
<a href="http://java.sun.com/getjava/download.html">Sun's Java site</a>.</p>

<p>
<applet code="org.nlogo.lite.Applet"
        archive="NetLogoLite.jar"
        width="853" height="552">
  <param name="DefaultModel"
         value="apo.nlogo">
</applet>
</p>

<p>powered by
<a target="_blank" href="http://ccl.northwestern.edu/netlogo/">NetLogo</a></p>

<p>view/download model file:
<a href="apo.nlogo">apo.nlogo</a>
</p>
<h2>WHAT IS IT?</h2>
<p>This simulation examines the application of artificial physics to the task of noisy function optimization. We call this &quot;artificial physics optimization&quot; (APO).</p><br>
<h2>HOW IT WORKS</h2>
<p>Multiple particles use F = ma and a &quot;split Newtonian&quot; force law to self-organize into a triangular lattice.  However, the algorithm has been extended to perform function optimization as follows.</p>
<p>There is a function f(x, y) defined for all (x, y) points in the environment. Furthermore, this function is noisy, i.e., if you compute f(x, y) multiple times, you will get multiple function values for the same values of x and y. This occurs in the real world because the function values can only be measured via noisy sensors, or because the function is itself changing over time.</p>
<p>Suppose two neighboring particles in the lattice are labeled 'a' and 'b.' These two particles are at coordinate positions (x_a, y_a) and (x_b, y_b) respectively.  Let f_a = f(x_a, y_a) and f_b = f(x_b, y_b) be the (noisy) fitness values associated with particles 'a' and 'b.'</p>
<p>In addition to the normal split Newtonian force that creates triangular lattices, one more force is applied to neighboring pairs of particles that depends on the function values. Suppose that we want to find the minimum of the function.  Then if f_a &lt; f_b, particle 'b' is attracted to 'a,' while particle 'a' is repelled from 'b.' Otherwise, particle 'a' is attracted to 'b,' while particle 'b' is repelled from 'a.' If we want to find the maximum of the function, this logic is reversed. Note that this is a deliberate breaking of the Newtonian assumption that forces are &quot;equal and opposite.&quot;</p>
<p>In this simulation we assume that our particles are robots that are trying to find the minimum amount of chemical in some region. Chapter 19 extends this work to multiple dimensions and considers the situation when the optimum moves, thereby making the task much more difficult.</p><br>
<h2>HOW TO USE IT</h2>
<p>Press SETUP to initialize the particles and the patches.  The color of each patch is determined by the value of the function at that patch. You will notice a small delay, because it takes a while to compute the value of the function at every patch. </p>
<p>Once SETUP is complete, click MOVE ROBOTS. They will move towards the optimum of the function. In this simulation we are minimizing, and the minimal point is shown as a blue disk in the simulation.</p>
<p>The CLEAR PATCHES button will erase the patches, turning them black.</p>
<p>The NUMBER_OF_ROBOTS slider allows you to control the number of robots created at initialization. Changing this slider while the simulation is running will have no effect.</p>
<p>All other sliders will affect the simulation when it is running.</p>
<p>The most important slider is the NOISE slider. This controls the amount of noise in the function. If you move the NOISE slider all the way to the right, the amount of noise is 5,000,000. This is a very high level of noise.</p>
<p>The DISTANCE TO OPTIMUM monitor indicates the distance of the center of mass of the formation from the minimum at the current moment. The DISTANCE TO OPTIMUM graph displays the distance as a function of time.</p>
<p>This simulation has two other nice features.  First, you can &quot;zoom&quot; into the function, allowing you to see fine-level structure embedded in the function.  Each time you click ZOOM IN you &quot;zoom&quot; closer by a factor of 10.  The RESET button brings you back to the default view. The ZOOM IN button should be clicked after SETUP has been clicked and before you click MOVE ROBOTS.</p>
<p>Also, when the simulation is running, you can mouse click in the graphics pane. This moves the optimum to the location of your mouse. This allows you to move the optimum in real time, so you can see whether the formation of robots can resume its search for the optimum. NOTE: you are not &quot;dragging&quot; the goal with the mouse - you merely click once in the location where you want the goal to move to. This can be a slow process, because the values of the patches need to be recomputed.</p><br>
<h2>THINGS TO NOTICE</h2>
<p>Particles are initialized in a random cluster in the upper right portion of the graphics pane, and self-organize into a triangular lattice.  The default position of the optimum is at the lower left portion of the graphics pane.</p>
<p>Try running the simulation with the default settings.  You will see that the formation quickly locates the optimum.  The center of mass of the formation is drawn at each time step so you can see the trajectory that the formation follows. The function looks like a simple bowl, with the bottom of the bowl located at the lower left.  Brighter yellow patches are &quot;higher,&quot; whereas darker patches are &quot;lower.&quot;</p>
<p>If you move the NOISE slider while the simulation is running, the simulation will pause as the fitness values of all the patches are recomputed.</p><br>
<h2>THINGS TO TRY</h2>
<p>Start with the default zoom level of one. Run the simulation several times. Gradually increase the amount of noise. Look at the depiction of the function in the graphics pane (the yellow patches).  Is the global structure of the function still discernable? Can the robots find the optimum? How would you describe the trajectory? You might want to move the speed slider to the right when you increase the noise. </p>
<p>Zoom in once, so that the amount of zoom is 10. When there is no noise you will start to see some structure in the function. Run the simulation several times, gradually increasing the amount of noise. Is the optimization task more difficult? Why? An alternative way of viewing the &quot;zoom&quot; factor is that the function has not really changed, but that the spacing between particles has been reduced by a factor of 10. Does that viewpoint help explain the results?</p>
<p>Zoom in once more, so that the amount of zoom is 100. Now you should see definite structure (when there is no noise). Can the robots find the global minimum? If not, what happens and why? </p>
<p>Does increasing the number of robots and/or increasing the DESIRED_SEPARATION help the search process? If it does, explain why.</p>
<p>Regardless of the amount of zoom, you can always use the mouse to move the optimum. When you click in the graphic pane, the optimum moves to that location. Will the formation move towards the new location? This task is referred to as &quot;tracking.&quot; </p><br>
<h2>EXTENDING THE MODEL</h2>
<p>The noise used in this simulation is drawn from a uniform distribution. Try alternative forms of noise, such as Gaussian.</p>
<p>This simulation uses the &quot;Rastrigan&quot; function to optimize.  Try other functions - Chapters 18 and 19 provide a suite of commonly used functions.</p>
<p>The natural extension of this model is to higher dimensions. This is hard to do with NetLogo. See Chapter 19 for details about how to do this in C, where a comparison is made with particle swarm optimization (PSO) on nonstationary environments.</p>
<p>Note, in order to change any NetLogo simulation, you must have the source code (i.e., &quot;apo.nlogo&quot;) downloaded to your computer, as well as NetLogo itself. You can not change the code when you are running the simulation with your browser.</p><br>
<h2>NETLOGO FEATURES</h2>
<p>This simulation makes use of a NetLogo feature that allows the toroidal nature of the world to be turned off, creating an environment with strict boundaries.</p>
<p>This simulation also creates the variable &quot;fitness&quot; for every patch. This variable is used to store the function value f(x,y) at every patch.</p>
<p>Also, mouse events are used to move the global optimum of the function, allowing you to &quot;translate&quot; the function in the Cartesian coordinate system.</p><br>
<h2>RELATED MODELS</h2>
<p>Chapter 18 of the book provides an alternative approach towards using artificial physics for function optimization. You might be interested in modifying this version of APO to run as described in Chapter 18.</p><br>
<h2>HOW TO CITE</h2>
<p>If you mention this model in an academic publication, we ask that you include these citations for the model itself and for the NetLogo software:<br>- Spears, W. M. and Spears, D. F. (eds.) Physics-based Swarm Intelligence: From Theory to Practice, Springer-Verlag, (2011).<br>- Wilensky, U. (1999). NetLogo. <a href="http://ccl.northwestern.edu/netlogo/">http://ccl.northwestern.edu/netlogo/</a>. Center for Connected Learning and Computer-Based Modeling, Northwestern University, Evanston, IL.</p><br>
<h2>COPYRIGHT NOTICE</h2>
<p>Copyright 2011 William M. Spears. All rights reserved.</p>
<p>Permission to use, modify or redistribute this model is hereby granted, provided that both of the following requirements are followed:<br>a) this copyright notice is included.<br>b) this model will not be redistributed for profit without permission from William M. Spears. Contact William M. Spears for appropriate licenses for redistribution for profit.</p>
<p><a href="http://www.swarmotics.com">http://www.swarmotics.com</a></p><br>
<h2>PROCEDURES</h2>
<pre><font color="#5a5a5a">; William M. Spears, September 2011</font><font color="#000000">
</font><font color="#5a5a5a">; Artificial Physics Optimization Tutorial Code</font><font color="#000000">
</font><font color="#5a5a5a">; For research and educational use only</font><font color="#000000">

</font><font color="#660096">breed</font><font color="#000000"> [apo-robots apo-robot]                          </font><font color="#5a5a5a">; Introduce the &quot;apo-robot&quot; breed</font><font color="#000000">
</font><font color="#007f69">globals</font><font color="#000000"> [center_of_mass_x center_of_mass_y Noise_Level
         G FR D FMAX DeltaT apoF APOMIN OPTX OPTY zoom numbots]                   

</font><font color="#007f69">turtles-own</font><font color="#000000"> [hood r F Fx Fy v vx vy dvx dvy deltax deltay]

</font><font color="#007f69">patches-own</font><font color="#000000"> [fitness]                                 </font><font color="#5a5a5a">; Store fitness landscape for visualization</font><font color="#000000">

</font><font color="#5a5a5a">;; This code assumes APO is minimizing</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> setup
   </font><font color="#0000aa">clear-all</font><font color="#000000">                                          </font><font color="#5a5a5a">; Clear everything </font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> numbots Number_of_Robots
   </font><font color="#0000aa">set</font><font color="#000000"> Noise_Level Noise                              </font><font color="#5a5a5a">; Used to detect if the Noise slider changes</font><font color="#000000">
   update-info

   </font><font color="#0000aa">set</font><font color="#000000"> OPTX </font><font color="#963700">-125</font><font color="#000000">                                      </font><font color="#5a5a5a">; Location of optimum</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> OPTY </font><font color="#963700">-125</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> apoF </font><font color="#963700">0.10</font><font color="#000000">                                      </font><font color="#5a5a5a">; See theory in Chapter 6</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> zoom </font><font color="#963700">1</font><font color="#000000">     
                                                      </font><font color="#5a5a5a">; Create and initialize particles</font><font color="#000000">
   create-apo-robots Number_of_Robots [setup-apo-robots]
                                                      </font><font color="#5a5a5a">; Computes center of mass and displays location</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> center_of_mass_x (</font><font color="#660096">sum</font><font color="#000000"> [</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> apo-robots) </font><font color="#660096">/</font><font color="#000000"> numbots
   </font><font color="#0000aa">set</font><font color="#000000"> center_of_mass_y (</font><font color="#660096">sum</font><font color="#000000"> [</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> apo-robots) </font><font color="#660096">/</font><font color="#000000"> numbots
   </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patch</font><font color="#000000"> (</font><font color="#660096">round</font><font color="#000000"> center_of_mass_x) (</font><font color="#660096">round</font><font color="#000000"> center_of_mass_y) [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">magenta</font><font color="#000000">]
                                                      </font><font color="#5a5a5a">; Distance of center of mass to optimum</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> APOMIN </font><font color="#660096">sqrt</font><font color="#000000">((center_of_mass_x </font><font color="#660096">-</font><font color="#000000"> OPTX) </font><font color="#660096">*</font><font color="#000000"> (center_of_mass_x </font><font color="#660096">-</font><font color="#000000"> OPTX) </font><font color="#660096">+</font><font color="#000000">
                   (center_of_mass_y </font><font color="#660096">-</font><font color="#000000"> OPTY) </font><font color="#660096">*</font><font color="#000000"> (center_of_mass_y </font><font color="#660096">-</font><font color="#000000"> OPTY))
 
   calculate-patches
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> run-and-monitor
   </font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) [</font><font color="#0000aa">user-message</font><font color="#000000"> </font><font color="#963700">&quot;Please click HALT and then SETUP first&quot;</font><font color="#000000"> </font><font color="#0000aa">stop</font><font color="#000000">]

   update-info
   </font><font color="#0000aa">set</font><font color="#000000"> G (</font><font color="#963700">0.9</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> FMAX </font><font color="#660096">*</font><font color="#000000"> (D </font><font color="#660096">^</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">) </font><font color="#660096">/</font><font color="#000000"> (</font><font color="#963700">2</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#660096">sqrt</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000">)))      </font><font color="#5a5a5a">; Gravitational constant set by theory</font><font color="#000000">
   </font><font color="#0000aa">ask</font><font color="#000000"> apo-robots [update-apo-robots]
   </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">   [move]

   </font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">mouse-down?</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">mouse-inside?</font><font color="#000000">) [               </font><font color="#5a5a5a">; Use mouse click to move optimum</font><font color="#000000">
      </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patch</font><font color="#000000"> OPTX OPTY [</font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">in-radius</font><font color="#000000"> </font><font color="#963700">6</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">]]
      </font><font color="#0000aa">set</font><font color="#000000"> OPTX </font><font color="#660096">mouse-xcor</font><font color="#000000">                             </font><font color="#5a5a5a">; Reset x-coordinate of optimum</font><font color="#000000">
      </font><font color="#0000aa">set</font><font color="#000000"> OPTY </font><font color="#660096">mouse-ycor</font><font color="#000000">                             </font><font color="#5a5a5a">; Reset y-coordinate of optimum</font><font color="#000000">
      calculate-patches
   ]
                                                      </font><font color="#5a5a5a">; Draw the location of the optimum   </font><font color="#000000">
   </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patch</font><font color="#000000"> OPTX OPTY [</font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">in-radius</font><font color="#000000"> </font><font color="#963700">6</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">blue</font><font color="#000000">]]
                                                      </font><font color="#5a5a5a">; Computes center of mass and displays location   </font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> center_of_mass_x (</font><font color="#660096">sum</font><font color="#000000"> [</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> apo-robots) </font><font color="#660096">/</font><font color="#000000"> numbots
   </font><font color="#0000aa">set</font><font color="#000000"> center_of_mass_y (</font><font color="#660096">sum</font><font color="#000000"> [</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> apo-robots) </font><font color="#660096">/</font><font color="#000000"> numbots
   </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patch</font><font color="#000000"> (</font><font color="#660096">round</font><font color="#000000"> center_of_mass_x) (</font><font color="#660096">round</font><font color="#000000"> center_of_mass_y) [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">magenta</font><font color="#000000">]
                                                      </font><font color="#5a5a5a">; Distance of center of mass to optimum  </font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> APOMIN </font><font color="#660096">sqrt</font><font color="#000000">((center_of_mass_x </font><font color="#660096">-</font><font color="#000000"> OPTX) </font><font color="#660096">*</font><font color="#000000"> (center_of_mass_x </font><font color="#660096">-</font><font color="#000000"> OPTX) </font><font color="#660096">+</font><font color="#000000">
                   (center_of_mass_y </font><font color="#660096">-</font><font color="#000000"> OPTY) </font><font color="#660096">*</font><font color="#000000"> (center_of_mass_y </font><font color="#660096">-</font><font color="#000000"> OPTY))
   do-plot                                            </font><font color="#5a5a5a">; Update graph</font><font color="#000000">
   </font><font color="#0000aa">tick</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> setup-apo-robots                                   </font><font color="#5a5a5a">; Set up the robots</font><font color="#000000">
   </font><font color="#0000aa">setxy</font><font color="#000000"> ((</font><font color="#660096">world-width</font><font color="#000000"> </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000">) </font><font color="#660096">+</font><font color="#000000"> (</font><font color="#660096">random-normal</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">)) 
         ((</font><font color="#660096">world-height</font><font color="#000000"> </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000">) </font><font color="#660096">+</font><font color="#000000"> (</font><font color="#660096">random-normal</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">))   </font><font color="#5a5a5a">; Place at upper right</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> vx </font><font color="#963700">0</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> vy </font><font color="#963700">0</font><font color="#000000">                                  </font><font color="#5a5a5a">; Start with no motion (and no linear momentum)</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;circle&quot;</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">magenta</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#963700">6</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">
   
</font><font color="#007f69">to</font><font color="#000000"> update-apo-robots                                  </font><font color="#5a5a5a">; Run artificial physics</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> Fx </font><font color="#963700">0</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> Fy </font><font color="#963700">0</font><font color="#000000">                                  </font><font color="#5a5a5a">; Initialize force components to zero</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> vx (</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> FR) </font><font color="#660096">*</font><font color="#000000"> vx                               </font><font color="#5a5a5a">; Slow down according to friction</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> vy (</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> FR) </font><font color="#660096">*</font><font color="#000000"> vy 
   
   </font><font color="#0000aa">set</font><font color="#000000"> hood [</font><font color="#660096">who</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">other</font><font color="#000000"> apo-robots                 </font><font color="#5a5a5a">; Get the IDs of your neighbors</font><font color="#000000">
   </font><font color="#0000aa">foreach</font><font color="#000000"> hood [         
      </font><font color="#0000aa">set</font><font color="#000000"> deltax (([</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> apo-robot ?) </font><font color="#660096">-</font><font color="#000000"> </font><font color="#660096">xcor</font><font color="#000000">) 
      </font><font color="#0000aa">set</font><font color="#000000"> deltay (([</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> apo-robot ?) </font><font color="#660096">-</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000">) 
      </font><font color="#0000aa">set</font><font color="#000000"> r </font><font color="#660096">sqrt</font><font color="#000000"> (deltax </font><font color="#660096">*</font><font color="#000000"> deltax </font><font color="#660096">+</font><font color="#000000"> deltay </font><font color="#660096">*</font><font color="#000000"> deltay)
      
      </font><font color="#0000aa">if</font><font color="#000000"> (r </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">1.5</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> D) [                              </font><font color="#5a5a5a">; The generalized split Newtonian law</font><font color="#000000">
         </font><font color="#0000aa">set</font><font color="#000000"> F (G </font><font color="#660096">/</font><font color="#000000"> (r </font><font color="#660096">^</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">)) 
         </font><font color="#0000aa">if</font><font color="#000000"> (F </font><font color="#660096">&gt;</font><font color="#000000"> FMAX) [</font><font color="#0000aa">set</font><font color="#000000"> F FMAX]                   </font><font color="#5a5a5a">; Bounds check on force magnitude</font><font color="#000000">
         </font><font color="#0000aa">ifelse</font><font color="#000000"> (r </font><font color="#660096">&gt;</font><font color="#000000"> D) 
            [</font><font color="#0000aa">set</font><font color="#000000"> Fx (Fx </font><font color="#660096">+</font><font color="#000000"> F </font><font color="#660096">*</font><font color="#000000"> (deltax </font><font color="#660096">/</font><font color="#000000"> r))           </font><font color="#5a5a5a">; Attractive force, x-component</font><font color="#000000">
             </font><font color="#0000aa">set</font><font color="#000000"> Fy (Fy </font><font color="#660096">+</font><font color="#000000"> F </font><font color="#660096">*</font><font color="#000000"> (deltay </font><font color="#660096">/</font><font color="#000000"> r))]          </font><font color="#5a5a5a">; Attractive force, y-component</font><font color="#000000">
            [</font><font color="#0000aa">set</font><font color="#000000"> Fx (Fx </font><font color="#660096">-</font><font color="#000000"> F </font><font color="#660096">*</font><font color="#000000"> (deltax </font><font color="#660096">/</font><font color="#000000"> r))           </font><font color="#5a5a5a">; Repulsive force, x-component</font><font color="#000000">
             </font><font color="#0000aa">set</font><font color="#000000"> Fy (Fy </font><font color="#660096">-</font><font color="#000000"> F </font><font color="#660096">*</font><font color="#000000"> (deltay </font><font color="#660096">/</font><font color="#000000"> r))]          </font><font color="#5a5a5a">; Repulsive force, y-component</font><font color="#000000">
                                                      </font><font color="#5a5a5a">; The modification to AP that performs optimization!</font><font color="#000000">
         </font><font color="#0000aa">ifelse</font><font color="#000000"> ((rastrigan </font><font color="#660096">xcor</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000"> Noise_Level) </font><font color="#660096">&lt;</font><font color="#000000">  </font><font color="#5a5a5a">; Move towards fitness minimum</font><font color="#000000">
                 (rastrigan ([</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> apo-robot ?) 
                            ([</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> apo-robot ?) Noise_Level))
            [</font><font color="#0000aa">set</font><font color="#000000"> Fx (Fx </font><font color="#660096">-</font><font color="#000000"> (apoF </font><font color="#660096">*</font><font color="#000000"> (deltax </font><font color="#660096">/</font><font color="#000000"> r)))      </font><font color="#5a5a5a">; Repulsive force, x-component</font><font color="#000000">
             </font><font color="#0000aa">set</font><font color="#000000"> Fy (Fy </font><font color="#660096">-</font><font color="#000000"> (apoF </font><font color="#660096">*</font><font color="#000000"> (deltay </font><font color="#660096">/</font><font color="#000000"> r)))]     </font><font color="#5a5a5a">; Repulsive force, y-component</font><font color="#000000">
            [</font><font color="#0000aa">set</font><font color="#000000"> Fx (Fx </font><font color="#660096">+</font><font color="#000000"> (apoF </font><font color="#660096">*</font><font color="#000000"> (deltax </font><font color="#660096">/</font><font color="#000000"> r)))      </font><font color="#5a5a5a">; Attractive force, x-component</font><font color="#000000">
             </font><font color="#0000aa">set</font><font color="#000000"> Fy (Fy </font><font color="#660096">+</font><font color="#000000"> (apoF </font><font color="#660096">*</font><font color="#000000"> (deltay </font><font color="#660096">/</font><font color="#000000"> r)))]     </font><font color="#5a5a5a">; Attractive force, y-component</font><font color="#000000">
      ]
   ]
   
   </font><font color="#0000aa">set</font><font color="#000000"> dvx DeltaT </font><font color="#660096">*</font><font color="#000000"> Fx
   </font><font color="#0000aa">set</font><font color="#000000"> dvy DeltaT </font><font color="#660096">*</font><font color="#000000"> Fy
   </font><font color="#0000aa">set</font><font color="#000000"> vx  (vx </font><font color="#660096">+</font><font color="#000000"> dvx)                                 </font><font color="#5a5a5a">; The x-component of velocity</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> vy  (vy </font><font color="#660096">+</font><font color="#000000"> dvy)                                 </font><font color="#5a5a5a">; The y-component of velocity</font><font color="#000000">

   </font><font color="#0000aa">set</font><font color="#000000"> deltax DeltaT </font><font color="#660096">*</font><font color="#000000"> vx
   </font><font color="#0000aa">set</font><font color="#000000"> deltay DeltaT </font><font color="#660096">*</font><font color="#000000"> vy 
   </font><font color="#0000aa">if</font><font color="#000000"> ((deltax </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">or</font><font color="#000000"> (deltay </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">)) 
      [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> (</font><font color="#660096">atan</font><font color="#000000"> deltax deltay)] 
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> move
   </font><font color="#0000aa">fd</font><font color="#000000"> (</font><font color="#660096">sqrt</font><font color="#000000"> (deltax </font><font color="#660096">*</font><font color="#000000"> deltax </font><font color="#660096">+</font><font color="#000000"> deltay </font><font color="#660096">*</font><font color="#000000"> deltay))      </font><font color="#5a5a5a">; Move the robot </font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> update-info                                        </font><font color="#5a5a5a">; Update information from the sliders </font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> FMAX Force_Maximum
   </font><font color="#0000aa">set</font><font color="#000000"> FR Friction
   </font><font color="#0000aa">set</font><font color="#000000"> DeltaT Time_Step
   </font><font color="#0000aa">set</font><font color="#000000"> D Desired_Separation
   </font><font color="#0000aa">if</font><font color="#000000"> (Noise </font><font color="#660096">!=</font><font color="#000000"> Noise_Level) [                        </font><font color="#5a5a5a">; If the amount of noise changes,</font><font color="#000000">
      </font><font color="#0000aa">set</font><font color="#000000"> Noise_Level Noise                           </font><font color="#5a5a5a">; note this fact, and</font><font color="#000000">
      calculate-patches                               </font><font color="#5a5a5a">; recalculate the fitness values of the patches</font><font color="#000000">
   ]
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to-report</font><font color="#000000"> rastrigan [x y n]                           </font><font color="#5a5a5a">; Computes the Rastrigan function (n = noise level)</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> x (x </font><font color="#660096">/</font><font color="#000000"> zoom)
   </font><font color="#0000aa">set</font><font color="#000000"> y (y </font><font color="#660096">/</font><font color="#000000"> zoom)
   </font><font color="#0000aa">let</font><font color="#000000"> tempx ((x </font><font color="#660096">-</font><font color="#000000"> OPTX </font><font color="#660096">/</font><font color="#000000"> zoom) </font><font color="#660096">^</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> (</font><font color="#963700">10</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">cos</font><font color="#000000"> (</font><font color="#963700">360</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> (x </font><font color="#660096">-</font><font color="#000000"> OPTX </font><font color="#660096">/</font><font color="#000000"> zoom))) </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000">)
   </font><font color="#0000aa">let</font><font color="#000000"> tempy ((y </font><font color="#660096">-</font><font color="#000000"> OPTY </font><font color="#660096">/</font><font color="#000000"> zoom) </font><font color="#660096">^</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> (</font><font color="#963700">10</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">cos</font><font color="#000000"> (</font><font color="#963700">360</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> (y </font><font color="#660096">-</font><font color="#000000"> OPTY </font><font color="#660096">/</font><font color="#000000"> zoom))) </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000">)
   </font><font color="#0000aa">report</font><font color="#000000"> (tempx </font><font color="#660096">+</font><font color="#000000"> tempy </font><font color="#660096">+</font><font color="#000000"> (n </font><font color="#660096">*</font><font color="#000000"> ((</font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">1.0</font><font color="#000000">) </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">0.5</font><font color="#000000">)))
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> zoom-in                                            </font><font color="#5a5a5a">; Increase the zoom by a factor of 10</font><font color="#000000">
   </font><font color="#0000aa">if</font><font color="#000000"> (zoom </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) [</font><font color="#0000aa">user-message</font><font color="#000000"> </font><font color="#963700">&quot;Please click HALT and then SETUP first&quot;</font><font color="#000000"> </font><font color="#0000aa">stop</font><font color="#000000">] 
   </font><font color="#0000aa">set</font><font color="#000000"> zoom </font><font color="#963700">10</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> zoom
   calculate-patches                                  </font><font color="#5a5a5a">; Recalculate the fitness values of the patches</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> reset-zoom                                         </font><font color="#5a5a5a">; Reset the zoom back to 1</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> zoom </font><font color="#963700">1</font><font color="#000000">
   calculate-patches                                  </font><font color="#5a5a5a">; Recalculate the fitness values of the patches</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> calculate-patches                                  </font><font color="#5a5a5a">; Calculate the fitness values of the patches</font><font color="#000000">
   </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> fitness (rastrigan </font><font color="#660096">pxcor</font><font color="#000000"> </font><font color="#660096">pycor</font><font color="#000000"> Noise_Level)]
   </font><font color="#0000aa">let</font><font color="#000000"> lower </font><font color="#660096">min</font><font color="#000000"> [fitness] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000">                 </font><font color="#5a5a5a">; Find the minimum value</font><font color="#000000">
   </font><font color="#0000aa">let</font><font color="#000000"> upper </font><font color="#660096">max</font><font color="#000000"> [fitness] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000">                 </font><font color="#5a5a5a">; Find the maximum value</font><font color="#000000">
                                                      </font><font color="#5a5a5a">; Color the patches shades of yellow, scaled by the min and max</font><font color="#000000">
   </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> (</font><font color="#660096">scale-color</font><font color="#000000"> </font><font color="#963700">yellow</font><font color="#000000"> fitness lower upper)]
                                                      </font><font color="#5a5a5a">; Draw the location of the optimum</font><font color="#000000">
   </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patch</font><font color="#000000"> OPTX OPTY [</font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">in-radius</font><font color="#000000"> </font><font color="#963700">6</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">blue</font><font color="#000000">]]
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> do-plot
   </font><font color="#0000aa">set-current-plot</font><font color="#000000"> </font><font color="#963700">&quot;Distance to Optimum&quot;</font><font color="#000000">             </font><font color="#5a5a5a">; Select the &quot;Distance to Optimum&quot; plot</font><font color="#000000">
   </font><font color="#0000aa">set-current-plot-pen</font><font color="#000000"> </font><font color="#963700">&quot;apopen&quot;</font><font color="#000000">                      </font><font color="#5a5a5a">; Select the apo pen</font><font color="#000000">
   </font><font color="#0000aa">plot</font><font color="#000000"> APOMIN                                        </font><font color="#5a5a5a">; Plot the distance of the center of mass from the optimum</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">
</font>
</pre>

</body>
</html>
