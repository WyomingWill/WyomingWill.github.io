<html>
<head>
<title>best_fit_circles</title>
<style type="text/css">
<!--
/*
    This style sheet is borrowed from the NetLogo User Manual.  However, some of the units were
    changed from em to px because Java's StyleSheet support is limited for relative units such as
    em and % (this will supposively improve with newer versions of the VM) - jrn 7/21/05
    BE VERY VERY CAREFUL when you alter this style sheet -- it's possible to put in
    innocent-looking things that work on some VM's but cause Java exceptions on other for example
    we were using "font-size: 125%" but it caused Java exceptions on Java 1.5 on Windows - ST
    8/25/05
*/
:link { color: rgb(110,0,110); }
:visited { color: rgb(110,0,110); }
body {
    margin-left: 5px;
    font-family: arial, sans-serif;
    background: white;
    font-size: 12pt
}
h1 {
    color: white;
    background: rgb(45,0,45);
    font-size: 18pt;
    margin-bottom: 4px;
    padding-left: 6px;
    padding-right: 6px;
    padding-top: 6px;
    padding-bottom: 6px;
}
h2 {
    margin-top: 15px;
    margin-left: 6px;
    margin-bottom: 4px;
    background: rgb(166,172,255);
    font-size: 15pt;
    padding-left: 6px;
    padding-right: 6px;
    padding-top: 6px;
    padding-bottom: 6px;
}
h3 {
    margin-top: 15px;
    margin-left: 13px;
    margin-bottom: 4px;
    background: rgb(175,175,175);
    font-size: 12pt;
    padding: 0.2em;
    padding-left: 6px;
    padding-right: 6px;
    padding-top: 6px;
    padding-bottom: 6px;
}
h4 {
    margin-top: 15px;
    margin-bottom: 5px;
    margin-left: 15px;
    font-size: 12pt;
}
h5 {
    margin-top: 15px;
    margin-left: 15px;
    font-size: 12pt;
}
h6 {
    margin-top: 15px;
    margin-left: 15px;
    font-size: 12pt;
}
p {
    margin-left: 15px;
    margin-bottom: 3px;
}
pre {
    margin-left: 13px;
    background: rgb(225,225,225);
    font-family: monospace;
    font-size: 12pt;
    padding-left: 10px;
    padding-right: 3px;
    padding-top: 7px;
    padding-bottom: 7px;
    margin-top:9px;
    margin-bottom:0px;
}
code {
    font-family: monospace;
    font-size: 12pt;
}
blockquote {
    border: solid;
    border-style: solid;
    border-width: thin;
    border-color: black;
    background: rgb(250,250,220);
    padding-top: 0px;
    padding-bottom: 7px;
    margin-top: 7px;
    margin-bottom:1px;
}
ol {
   margin-bottom:1px;
}
ul {
   margin-bottom:1px;
}

-->
</style>
</head>
<body>

<p>This page was automatically generated by NetLogo 5.0.</p>

<p>The applet requires Java 5 or higher.
Java must be enabled in your browser settings.
Mac users must have Mac OS X 10.4 or higher.
Windows and Linux users may obtain the latest Java from
<a href="http://java.sun.com/getjava/download.html">Sun's Java site</a>.</p>

<p><hr>

<applet code="org.nlogo.lite.Applet"
        archive="NetLogoLite.jar"
        width="852" height="495">
  <param name="DefaultModel"
         value="best_fit_circles.nlogo">
  <param name="java_arguments"
         value="-Djnlp.packEnabled=true">
</applet>
</p>

<p>powered by
<a target="_blank" href="http://ccl.northwestern.edu/netlogo/">NetLogo</a></p>

<p>view/download model file:
<a href="best_fit_circles.nlogo">best_fit_circles.nlogo</a></p>
<h2>WHAT IS IT?</h2><p>This is a demonstration of using physicomimetics to find best fit circles for a set of fixed points.</p><h2>HOW IT WORKS</h2><p>Initially the centers of the circles are placed randomly in the graphics pane. At each iteration these virtual centers move closer to a solution.</p><p>The fixed points we are trying to fit do not move. Rather, the agents in this demo are line segments that run between those fixed points and our virtual centers. These line segments (called virtual radii or v.r.) change in length and direction as the virtual centers move, but they always have one end anchored on the fixed points we are trying to fit.</p><p>In the best fit circles, the differences between the virtual radii will be minimized, i.e. they will all be as close to being the same length as possible. So we create a system in which they all strive to be the same length. In each iteration, we compute the length of each v.r. and their average length. Then we compute a force that tends to expand or compress each v.r. in the direction of that average length.</p><p>Changing the length of the v.r. moves the endpoint that was formerly attached to a virtual center, creating a new endpoint that either projects beyond that center or falls short of that center. All of these new endpoints are computed, and their x- and y-coordinates are averaged to create a new virtual center that is closer to the solution than the previous virtual center was.</p><p>The next iteration begins by computing the new virtual radii, and iteration continues until the virtual centers stop moving*.</p><p>*The phrase &ldquo;stop moving&rdquo; is necessarily vague. The virtual centers seems to asymptotically approach the solution centers with the force law I have selected, so it never really stops, it just becomes slower and slower. Maybe it&rsquo;s better to say that the iteration continues until the rate of change is below the desired level of precision.</p><h2>WHAT IS NEW</h2><p>This simulation treats line segments as our agents, instead of particles. This simulation is <em>not</em> toroidal.</p><h2>HOW TO USE IT</h2><p>Click SETUP AGENTS to initialize the virtual centers. The number of virtual centers is determined by the NUMBER_OF_PARICLES slider. Then click MOVE AGENTS. Fixed points can be put in the environment by placing the mouse where you want the fixed point to be, and then clicking the mouse.</p><p>The CLEAR button will clear the graphics, which becomes handy when a lot of circles have been drawn.</p><p>The SPRING_CONSTANT slider controls the strength of the spring-like force law, FRICTION<br/>controls the amount of friction, and TIME_STEP controls the time granularity of the simulation. All three of these sliders will affect the simulation when it is running.</p><h2>THINGS TO NOTICE</h2><p>When you place your first fixed point into the system, what happens? Is this problem very interesting?</p><p>Now what happens when you place a second fixed point in the system? How many solutions are there to this problem?</p><p>As you keep adding fixed points, do you think there is only one unique solution?</p><p>The red dot shows the center of mass of the fixed points. Note that the virtual centers of the best fit circles are <em>not</em> usually at the center of mass. Why is that?</p><h2>THINGS TO TRY</h2><p>See how the FRICTION changes behavior. </p><p>Similarly, try different values for the SPRING_CONSTANT.</p><p>Put all your fixed points in a straight line to send the virtual centers to the opposite edge of the graphics pane.</p><h2>EXTENDING THE MODEL</h2><p>Try a different force law.</p><p>Try making the value of the SPRING_CONSTANT a function of the number of points and their distance from each other.</p><p>Allow fixed points to have different masses. Note that you can achieve a similar effect by clicking multiple times with your mouse in one location on the graphics pane.</p><p>Can you change the algorithm so that it will compute the smallest circle that encompasses all the fixed points?</p><p>Similarly, can you define an algorithm that tries to create the largest circles within the fixed points that do not include the fixed points? </p><p>Note, in order to change any NetLogo simulation, you must have the source code (i.e., &ldquo;best_fit_circles.nlogo&rdquo;) downloaded to your computer, as well as NetLogo itself. You can not change the code when you are running the simulation with your browser.</p><h2>NETLOGO FEATURES</h2><h2>RELATED MODELS</h2><p>This simulation is an extension of best_fit_circle.nlogo to multiple circles.</p><h2>CREDITS AND REFERENCES</h2><p>The idea and the algorithm by Rodney Heil. NetLogo code by W. M. Spears.</p><h2>HOW TO CITE</h2><p>If you mention this model in an academic publication, we ask that you include these citations for the model itself and for the NetLogo software:<br/>- Spears, W. M. and Spears, D. F. (eds.) Physicomimetics: Physics-Based Swarm Intelligence, Springer-Verlag, (2012).<br/>- Wilensky, U. (1999). NetLogo. <a href="http://ccl.northwestern.edu/netlogo/">http://ccl.northwestern.edu/netlogo/</a>. Center for Connected Learning and Computer-Based Modeling, Northwestern University, Evanston, IL.</p><h2>COPYRIGHT NOTICE</h2><p>Copyright 2012 William M. Spears. All rights reserved.</p><p>Permission to use, modify or redistribute this model is hereby granted, provided that both of the following requirements are followed:<br/>a) this copyright notice is included, and<br/>b) this model will not be redistributed for profit without permission from William M. Spears. Contact William M. Spears for appropriate licenses for redistribution for profit.</p><p><a href="http://www.swarmotics.com">http://www.swarmotics.com</a></p>

<h1>CODE</h1>
<pre><font color="#5a5a5a">; William M. Spears May 2012</font><font color="#000000">
</font><font color="#5a5a5a">; Idea and algorithm by Rodney Heil April 2012</font><font color="#000000">
</font><font color="#5a5a5a">; Finding the &quot;best fit&quot; circle for a set of fixed_points!</font><font color="#000000">
</font><font color="#5a5a5a">; You introduce the fixed_points with your mouse.</font><font color="#000000">
</font><font color="#5a5a5a">; For research and educational use only</font><font color="#000000">

</font><font color="#660096">breed</font><font color="#000000"> [particles particle]                                </font><font color="#5a5a5a">; Introduce the &quot;particle&quot; breed</font><font color="#000000">
</font><font color="#660096">breed</font><font color="#000000"> [fixed_points fixed_point]                          </font><font color="#5a5a5a">; Introduce the &quot;fixed_point&quot; breed</font><font color="#000000">

</font><font color="#007f69">globals</font><font color="#000000"> [center_of_mass_x center_of_mass_y]

</font><font color="#007f69">turtles-own</font><font color="#000000"> [hood deltax deltay r F Fx Fy v vx vy dvx dvy mass ave_dist]

</font><font color="#007f69">to</font><font color="#000000"> setup
   </font><font color="#0000aa">clear-all</font><font color="#000000">                                              </font><font color="#5a5a5a">; Clear everything</font><font color="#000000">
   create-particles Number_of_Particles [setup-particles] </font><font color="#5a5a5a">; Create the particles                                           </font><font color="#000000">
   </font><font color="#0000aa">reset-ticks</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> setup-particles                                        </font><font color="#5a5a5a">; Set up the particles</font><font color="#000000">
   </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#660096">random-xcor</font><font color="#000000"> </font><font color="#660096">random-ycor</font><font color="#000000">                          </font><font color="#5a5a5a">; Randomly initialized locations</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">360</font><font color="#000000">                                 </font><font color="#5a5a5a">; Everyone has a random heading</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> vx </font><font color="#963700">0</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> vy </font><font color="#963700">0</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> mass </font><font color="#963700">1</font><font color="#000000">                           </font><font color="#5a5a5a">; Start with no motion and mass = 1</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">white</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;circle&quot;</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#963700">5</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> run-and-monitor
   </font><font color="#0000aa">if</font><font color="#000000"> ((</font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">) </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) [</font><font color="#0000aa">user-message</font><font color="#000000"> </font><font color="#963700">&quot;Please click HALT and then SETUP AGENTS first&quot;</font><font color="#000000"> </font><font color="#0000aa">stop</font><font color="#000000">]
   
   </font><font color="#0000aa">if</font><font color="#000000"> ((</font><font color="#660096">count</font><font color="#000000"> fixed_points) </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) [
      </font><font color="#0000aa">ask</font><font color="#000000"> particles [ap-particles]
      </font><font color="#5a5a5a">; Display circle of average radius around particle</font><font color="#000000">
      </font><font color="#0000aa">ask</font><font color="#000000"> particles [draw-circle </font><font color="#660096">who</font><font color="#000000"> (</font><font color="#660096">round</font><font color="#000000"> </font><font color="#660096">xcor</font><font color="#000000">) (</font><font color="#660096">round</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000">) (</font><font color="#660096">round</font><font color="#000000"> ave_dist)] 
      
      </font><font color="#5a5a5a">; Computes center of mass and displays location</font><font color="#000000">
      </font><font color="#0000aa">set</font><font color="#000000"> center_of_mass_x (</font><font color="#660096">sum</font><font color="#000000"> [</font><font color="#660096">xcor</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> mass] </font><font color="#660096">of</font><font color="#000000"> fixed_points) </font><font color="#660096">/</font><font color="#000000"> (</font><font color="#660096">sum</font><font color="#000000"> [mass] </font><font color="#660096">of</font><font color="#000000"> fixed_points)
      </font><font color="#0000aa">set</font><font color="#000000"> center_of_mass_y (</font><font color="#660096">sum</font><font color="#000000"> [</font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> mass] </font><font color="#660096">of</font><font color="#000000"> fixed_points) </font><font color="#660096">/</font><font color="#000000"> (</font><font color="#660096">sum</font><font color="#000000"> [mass] </font><font color="#660096">of</font><font color="#000000"> fixed_points)
      </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patch</font><font color="#000000"> (</font><font color="#660096">round</font><font color="#000000"> center_of_mass_x) (</font><font color="#660096">round</font><font color="#000000"> center_of_mass_y)
         [</font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">in-radius</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000">]]
   ]
    
   </font><font color="#5a5a5a">; Use mouse click to create fixed_points. Must make sure that mouse is within black graphics pane.</font><font color="#000000">
   </font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">mouse-down?</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">mouse-inside?</font><font color="#000000">) [
      </font><font color="#0000aa">ifelse</font><font color="#000000"> ((</font><font color="#660096">count</font><font color="#000000"> fixed_points) </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) 
          [create-fixed_points </font><font color="#963700">1</font><font color="#000000"> [</font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> vx </font><font color="#963700">0</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> vy </font><font color="#963700">0</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;circle&quot;</font><font color="#000000"> 
                                  </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> mass </font><font color="#963700">1</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">green</font><font color="#000000">]]
          [</font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">one-of</font><font color="#000000"> fixed_points [</font><font color="#0000aa">hatch</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> [</font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">]]]
      </font><font color="#0000aa">wait</font><font color="#000000"> </font><font color="#963700">0.2</font><font color="#000000">                                            </font><font color="#5a5a5a">; Pause so don't get a bunch of fixed_points at once</font><font color="#000000">
   ]

   </font><font color="#0000aa">tick</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#5a5a5a">; Draw circle around particle w at (x, y) with radius d</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> draw-circle [w x y d]
   </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patch</font><font color="#000000"> x y
      [</font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">in-radius</font><font color="#000000"> (d </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) [</font><font color="#0000aa">if</font><font color="#000000"> ((</font><font color="#660096">round</font><font color="#000000"> </font><font color="#660096">distance</font><font color="#000000"> particle w) </font><font color="#660096">=</font><font color="#000000"> d) [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">yellow</font><font color="#000000">]]]
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> ap-particles                                           </font><font color="#5a5a5a">; Run artificial physics on the particles</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> Fx </font><font color="#963700">0</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> Fy </font><font color="#963700">0</font><font color="#000000">                                      </font><font color="#5a5a5a">; Initialize force components to zero</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> vx (</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> Friction) </font><font color="#660096">*</font><font color="#000000"> vx                             </font><font color="#5a5a5a">; Slow down according to friction</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> vy (</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> Friction) </font><font color="#660096">*</font><font color="#000000"> vy 
   </font><font color="#0000aa">set</font><font color="#000000"> ave_dist </font><font color="#963700">0</font><font color="#000000">
   
   </font><font color="#0000aa">set</font><font color="#000000"> hood [</font><font color="#660096">who</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> fixed_points                         </font><font color="#5a5a5a">; Get the IDs of fixed_points</font><font color="#000000">
   </font><font color="#0000aa">foreach</font><font color="#000000"> hood [         
      </font><font color="#0000aa">set</font><font color="#000000"> deltax (([</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> fixed_point ?) </font><font color="#660096">-</font><font color="#000000"> </font><font color="#660096">xcor</font><font color="#000000">) 
      </font><font color="#0000aa">set</font><font color="#000000"> deltay (([</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> fixed_point ?) </font><font color="#660096">-</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000">) 
      </font><font color="#0000aa">set</font><font color="#000000"> ave_dist ave_dist </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">sqrt</font><font color="#000000"> (deltax </font><font color="#660096">*</font><font color="#000000"> deltax </font><font color="#660096">+</font><font color="#000000"> deltay </font><font color="#660096">*</font><font color="#000000"> deltay)
   ]
   </font><font color="#0000aa">set</font><font color="#000000"> ave_dist (ave_dist </font><font color="#660096">/</font><font color="#000000"> (</font><font color="#660096">count</font><font color="#000000"> fixed_points))         </font><font color="#5a5a5a">; Compute average distance</font><font color="#000000">

   </font><font color="#0000aa">foreach</font><font color="#000000"> hood [ 
      </font><font color="#0000aa">set</font><font color="#000000"> deltax (([</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> fixed_point ?) </font><font color="#660096">-</font><font color="#000000"> </font><font color="#660096">xcor</font><font color="#000000">) 
      </font><font color="#0000aa">set</font><font color="#000000"> deltay (([</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> fixed_point ?) </font><font color="#660096">-</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000">)
      </font><font color="#0000aa">set</font><font color="#000000"> r </font><font color="#660096">sqrt</font><font color="#000000"> (deltax </font><font color="#660096">*</font><font color="#000000"> deltax </font><font color="#660096">+</font><font color="#000000"> deltay </font><font color="#660096">*</font><font color="#000000"> deltay)      </font><font color="#5a5a5a">; Compute the distance to each particle</font><font color="#000000">
      </font><font color="#0000aa">set</font><font color="#000000"> F (ave_dist </font><font color="#660096">-</font><font color="#000000"> r) </font><font color="#660096">*</font><font color="#000000"> Spring_Constant              </font><font color="#5a5a5a">; Simple linear force law</font><font color="#000000">
      </font><font color="#0000aa">set</font><font color="#000000"> Fx (Fx </font><font color="#660096">-</font><font color="#000000"> (F </font><font color="#660096">*</font><font color="#000000"> (deltax </font><font color="#660096">/</font><font color="#000000"> r)))                    </font><font color="#5a5a5a">; Repulsive force, x-component</font><font color="#000000">
      </font><font color="#0000aa">set</font><font color="#000000"> Fy (Fy </font><font color="#660096">-</font><font color="#000000"> (F </font><font color="#660096">*</font><font color="#000000"> (deltay </font><font color="#660096">/</font><font color="#000000"> r)))                    </font><font color="#5a5a5a">; Repulsive force, y-component</font><font color="#000000">
   ]
     
   </font><font color="#0000aa">set</font><font color="#000000"> dvx Time_Step </font><font color="#660096">*</font><font color="#000000"> (Fx </font><font color="#660096">/</font><font color="#000000"> mass)
   </font><font color="#0000aa">set</font><font color="#000000"> dvy Time_Step </font><font color="#660096">*</font><font color="#000000"> (Fy </font><font color="#660096">/</font><font color="#000000"> mass)
   </font><font color="#0000aa">set</font><font color="#000000"> vx  (vx </font><font color="#660096">+</font><font color="#000000"> dvx)                                     </font><font color="#5a5a5a">; The x-component of velocity</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> vy  (vy </font><font color="#660096">+</font><font color="#000000"> dvy)                                     </font><font color="#5a5a5a">; The y-component of velocity</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> v </font><font color="#660096">sqrt</font><font color="#000000"> (vx </font><font color="#660096">*</font><font color="#000000"> vx </font><font color="#660096">+</font><font color="#000000"> vy </font><font color="#660096">*</font><font color="#000000"> vy)

   </font><font color="#0000aa">set</font><font color="#000000"> deltax Time_Step </font><font color="#660096">*</font><font color="#000000"> vx
   </font><font color="#0000aa">set</font><font color="#000000"> deltay Time_Step </font><font color="#660096">*</font><font color="#000000"> vy 
   </font><font color="#0000aa">if</font><font color="#000000"> ((deltax </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">or</font><font color="#000000"> (deltay </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">)) 
      [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> (</font><font color="#660096">atan</font><font color="#000000"> deltax deltay)]
   </font><font color="#0000aa">fd</font><font color="#000000"> </font><font color="#660096">sqrt</font><font color="#000000"> (deltax </font><font color="#660096">*</font><font color="#000000"> deltax </font><font color="#660096">+</font><font color="#000000"> deltay </font><font color="#660096">*</font><font color="#000000"> deltay)            </font><font color="#5a5a5a">; Move the particle  </font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">
</font>
</pre>

</body>
</html>
